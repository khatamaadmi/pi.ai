import React from 'react';
import { getStoredChats } from '../utils/storage';
import { ChatHistoryView } from './ChatHistoryView';
import { useNavigate } from "react-router-dom";

export function History() {
    const chats = getStoredChats() || [];
    const navigate = useNavigate();

    if (chats.length === 0) {
        return (
            <div className="mx-auto px-5 pt-[150px] lg:pt-[200px]">
                <svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg"
                     className="mx-auto w-[120px]">
                    <path d="M95.3535 38.0806C94.7852 36.8262 93.4643 36.0864 92.0896 36.1939C91.3242 36.2528 90.6203 36.4473 89.9649 36.7443C89.2277 37.0796 88.5544 37.5455 87.9374 38.1241C87.1669 38.8434 86.6012 39.6831 86.1532 40.5918C85.8332 41.2369 85.5747 41.9178 85.352 42.6193C84.8477 44.2141 84.712 45.8652 84.5866 47.5189C84.5507 48.0079 84.5686 48.4994 84.5661 48.9909C84.5661 49.3518 84.6019 49.7179 84.5712 50.0763C84.4407 51.6557 84.2948 53.2326 84.1488 54.8095C83.9927 56.4965 83.8468 58.1835 83.4884 59.8423C83.2426 60.9814 82.9021 62.2076 82.6897 62.6556C82.6897 62.6556 82.4669 63.4261 82.2519 63.4261C82.0369 63.4261 82.1342 62.2793 82.1316 62.054C82.1188 60.6487 82.2699 59.9677 82.3313 58.5854C82.4465 55.9845 82.641 53.3836 82.6845 50.7802C82.7229 48.4507 82.641 46.1186 82.5822 43.7891C82.5796 43.6432 82.5745 43.4973 82.5693 43.3514C82.5463 42.4068 82.4798 41.4596 82.385 40.5176C82.321 39.9058 82.2109 39.2888 82.0446 38.6975C81.7246 37.5507 80.8619 37.0208 79.6562 37.2179C79.2953 37.2768 78.9522 37.4175 78.6348 37.6044C78.2815 37.8118 77.9462 38.055 77.6364 38.3212C76.5664 39.253 75.7524 40.3819 75.1252 41.6593C73.7173 44.5187 72.9339 47.5292 73.0465 50.7214C73.0568 51.0029 73.0798 51.2845 73.0977 51.5661C73.1975 53.0637 73.3972 54.5561 73.4843 56.0536C73.579 57.7073 73.6302 59.3661 73.5994 61.0198C73.5636 62.8988 73.1771 64.7419 72.8878 66.5927C72.532 68.8736 72.1608 70.5606 70.8066 72.4114C70.6735 72.5931 70.095 73.2792 69.7289 73.3739C69.3628 73.4686 69.6905 72.5778 69.7187 72.4114C69.9823 70.8499 70.2562 69.5981 70.5404 68.0416C70.8348 66.4315 71.2136 64.8315 71.444 63.2137C71.7154 61.304 71.8894 59.3789 72.0635 57.459C72.1685 56.2994 72.1915 55.1295 72.0046 53.9699C71.9355 53.5398 71.828 53.1225 71.7 52.7155C71.5055 52.1037 71.2469 51.5175 70.8834 50.9748C70.2588 50.0379 69.327 49.6718 68.2723 50.0353C66.4164 50.6727 64.9777 51.7991 64.2712 53.7088C64.1201 54.1132 64.005 54.5279 63.9051 54.9426C63.6978 55.7976 63.5749 56.6706 63.5058 57.5537C63.3496 59.5325 63.2191 61.5113 63.068 63.4927C62.8684 66.1217 62.1593 68.6074 60.9741 70.9625C60.0013 72.8978 58.578 74.426 56.8193 75.6625C56.4021 75.9543 55.5573 76.4612 55.3601 76.2308C55.163 76.0004 56.1358 74.8996 56.4251 74.4798C57.6462 72.7109 58.8596 70.9369 59.799 68.9939C60.4492 67.65 61.0636 66.2958 61.3427 64.811C61.4399 64.2939 61.2505 64.0968 60.7282 64.2172C59.5405 64.4936 58.3552 64.7701 57.1674 65.0414C56.1793 65.2667 52.0297 66.5876 51.8454 64.7138C51.8096 64.3503 51.9606 63.997 52.1296 63.6744C52.7056 62.5737 53.5222 61.4909 54.6255 60.8816C56.6785 59.745 58.45 58.2219 60.1472 56.6143C60.6848 56.1048 61.1328 55.4981 61.6192 54.9324C61.9391 54.5612 62.2617 54.1926 62.5663 53.8137C62.597 53.7753 62.6303 53.7318 62.6636 53.6883C60.6412 51.561 57.2366 48.3176 53.6169 44.5264C51.5306 46.0649 49.4468 47.606 47.3605 49.1445C45.0873 50.8186 42.8294 52.5133 40.5358 54.1567C35.654 57.6587 31.3918 61.7469 28.4889 67.0586C24.6567 74.0779 22.6216 82.2517 20.2486 89.8392C18.7536 94.6237 17.5325 99.4721 17.0026 104.474C16.9693 104.789 17.0308 105.037 17.1844 105.296C17.6247 106.046 18.2262 106.645 18.8764 107.211C23.643 111.342 30.1835 113.482 36.3811 114.128C38.301 114.327 41.5316 114.77 42.4045 112.515C42.5812 112.057 42.7911 111.611 42.9831 111.158C43.5334 109.868 44.1529 108.603 44.6137 107.285C45.2793 105.375 46.0549 103.514 46.8433 101.653C48.9501 96.6818 52.0016 93.0749 56.8859 90.7275C60.2573 89.1071 63.667 87.5993 66.9616 85.8458C69.5625 84.4609 72.0815 82.9172 74.5927 81.3685C75.9059 80.557 77.1782 79.6559 78.3737 78.678C82.9047 74.9815 86.2274 70.3814 88.2651 64.9058C90.0059 60.2339 91.6519 55.5289 93.111 50.7546C94.117 47.4575 94.9107 44.1168 95.653 40.7582C95.8553 39.8469 95.735 38.9432 95.3458 38.0806H95.3535Z" fill="#58A6FE"/>
                </svg>
                <p className="text-3xl font-[550] text-[#0D3C26] md:text-center py-6 text-center md:py-9">
                    No Chat History Available
                </p>
                <button
                    onClick={() => navigate('/talk')}
                    className="flex items-center justify-center whitespace-nowrap h-12 rounded-lg px-8 text-white bg-[#0D3C26] hover:bg-emerald-950 mx-auto mt-3"
                    type="button"
                >
                    Try Me
                </button>
            </div>
        );
    }

    return (
        <div className="p-6 py-12 h-screen overflow-scroll scrollbar-hide">
            <h1 className="text-4xl font-serif text-center mb-8">Your Chat History with Pi</h1>
            <div className="space-y-8">
                {chats.map((chat) => (
                    <ChatHistoryView key={chat.id} chat={chat} />
                ))}
            </div>
        </div>
    );
}